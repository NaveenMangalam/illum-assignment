/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Device, DevicePlatform, DeviceType } from './device.model';
/**
 * see https://github.com/spring-projects/spring-mobile
 */
export class DeviceService {
    /**
     * @param {?} userAgent
     * @return {?}
     */
    static resolveDevice(userAgent) {
        if (!userAgent) {
            return new Device(DeviceType.NORMAL, DevicePlatform.UNKNOWN);
        }
        userAgent = userAgent.toLowerCase();
        /**
         * Tablet Detection
         */
        // Apple
        if (userAgent.includes('ipad')) {
            return new Device(DeviceType.TABLET, DevicePlatform.IOS);
        }
        /** @type {?} */
        const isMobile = userAgent.includes('mobile') ||
            DeviceService.KNOWN_MOBILE_USER_AGENT_KEYWORDS.some((/**
             * @param {?} mobileUserAgent
             * @return {?}
             */
            mobileUserAgent => userAgent.includes(mobileUserAgent)));
        if (!isMobile) {
            // Android
            if (userAgent.includes('android')) {
                return new Device(DeviceType.TABLET, DevicePlatform.ANDROID);
            }
            // Kindle Fire
            if (userAgent.includes('silk')) {
                return new Device(DeviceType.TABLET, DevicePlatform.UNKNOWN);
            }
        }
        // From keywords
        if (DeviceService.KNOWN_TABLET_USER_AGENT_KEYWORDS.some((/**
         * @param {?} tabletUserAgent
         * @return {?}
         */
        tabletUserAgent => userAgent.includes(tabletUserAgent)))) {
            return new Device(DeviceType.TABLET, DevicePlatform.UNKNOWN);
        }
        /**
         * Mobile detection
         */
        // From prefix
        if (userAgent.length >= 4 &&
            DeviceService.KNOWN_MOBILE_USER_AGENT_PREFIXES.indexOf(userAgent.substring(0, 4)) !== -1) {
            return new Device(DeviceType.MOBILE, DevicePlatform.UNKNOWN);
        }
        // Android
        if (userAgent.includes('android')) {
            return new Device(DeviceType.MOBILE, DevicePlatform.ANDROID);
        }
        // Apple
        if (userAgent.includes('iphone') || userAgent.includes('ipod') || userAgent.includes('ipad')) {
            return new Device(DeviceType.MOBILE, DevicePlatform.IOS);
        }
        // From keywords
        if (isMobile) {
            return new Device(DeviceType.MOBILE, DevicePlatform.UNKNOWN);
        }
        /**
         * => Normal device
         */
        return new Device(DeviceType.NORMAL, DevicePlatform.UNKNOWN);
    }
}
DeviceService.KNOWN_MOBILE_USER_AGENT_PREFIXES = [
    'w3c ',
    'w3c-',
    'acs-',
    'alav',
    'alca',
    'amoi',
    'avan',
    'benq',
    'bird',
    'blac',
    'blaz',
    'brew',
    'cell',
    'cldc',
    'cmd-',
    'dang',
    'doco',
    'eric',
    'hipt',
    'htc_',
    'inno',
    'ipaq',
    'ipod',
    'jigs',
    'kddi',
    'keji',
    'leno',
    'lg-c',
    'lg-d',
    'lg-g',
    'lge-',
    'lg/u',
    'maui',
    'maxo',
    'midp',
    'mits',
    'mmef',
    'mobi',
    'mot-',
    'moto',
    'mwbp',
    'nec-',
    'newt',
    'noki',
    'palm',
    'pana',
    'pant',
    'phil',
    'play',
    'port',
    'prox',
    'qwap',
    'sage',
    'sams',
    'sany',
    'sch-',
    'sec-',
    'send',
    'seri',
    'sgh-',
    'shar',
    'sie-',
    'siem',
    'smal',
    'smar',
    'sony',
    'sph-',
    'symb',
    't-mo',
    'teli',
    'tim-',
    'tosh',
    'tsm-',
    'upg1',
    'upsi',
    'vk-v',
    'voda',
    'wap-',
    'wapa',
    'wapi',
    'wapp',
    'wapr',
    'webc',
    'winw',
    'winw',
    'xda ',
    'xda-'
];
DeviceService.KNOWN_MOBILE_USER_AGENT_KEYWORDS = [
    'blackberry',
    'webos',
    'ipod',
    'lge vx',
    'midp',
    'maemo',
    'mmp',
    'mobile',
    'netfront',
    'hiptop',
    'nintendo DS',
    'novarra',
    'openweb',
    'opera mobi',
    'opera mini',
    'palm',
    'psp',
    'phone',
    'smartphone',
    'symbian',
    'up.browser',
    'up.link',
    'wap',
    'windows ce'
];
DeviceService.KNOWN_TABLET_USER_AGENT_KEYWORDS = ['ipad', 'playbook', 'hp-tablet', 'kindle'];
if (false) {
    /**
     * @type {?}
     * @private
     */
    DeviceService.KNOWN_MOBILE_USER_AGENT_PREFIXES;
    /**
     * @type {?}
     * @private
     */
    DeviceService.KNOWN_MOBILE_USER_AGENT_KEYWORDS;
    /**
     * @type {?}
     * @private
     */
    DeviceService.KNOWN_TABLET_USER_AGENT_KEYWORDS;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Abmd4LXRvb2xraXQvZGV2aWNlLyIsInNvdXJjZXMiOlsibGliL2RldmljZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFFLGNBQWMsRUFBRSxVQUFVLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQzs7OztBQUtsRSxNQUFNLE9BQU8sYUFBYTs7Ozs7SUF3SHhCLE1BQU0sQ0FBQyxhQUFhLENBQUMsU0FBaUI7UUFDcEMsSUFBSSxDQUFDLFNBQVMsRUFBRTtZQUNkLE9BQU8sSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDOUQ7UUFFRCxTQUFTLEdBQUcsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBRXBDOztXQUVHO1FBRUgsUUFBUTtRQUNSLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUM5QixPQUFPLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1NBQzFEOztjQUVLLFFBQVEsR0FDWixTQUFTLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQztZQUM1QixhQUFhLENBQUMsZ0NBQWdDLENBQUMsSUFBSTs7OztZQUFDLGVBQWUsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsRUFBQztRQUM3RyxJQUFJLENBQUMsUUFBUSxFQUFFO1lBQ2IsVUFBVTtZQUNWLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsRUFBRTtnQkFDakMsT0FBTyxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUM5RDtZQUNELGNBQWM7WUFDZCxJQUFJLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQzlCLE9BQU8sSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7YUFDOUQ7U0FDRjtRQUNELGdCQUFnQjtRQUNoQixJQUFJLGFBQWEsQ0FBQyxnQ0FBZ0MsQ0FBQyxJQUFJOzs7O1FBQUMsZUFBZSxDQUFDLEVBQUUsQ0FBQyxTQUFTLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxFQUFDLEVBQUU7WUFDL0csT0FBTyxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztTQUM5RDtRQUVEOztXQUVHO1FBQ0gsY0FBYztRQUNkLElBQ0UsU0FBUyxDQUFDLE1BQU0sSUFBSSxDQUFDO1lBQ3JCLGFBQWEsQ0FBQyxnQ0FBZ0MsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLFNBQVMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsRUFDeEY7WUFDQSxPQUFPLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzlEO1FBQ0QsVUFBVTtRQUNWLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsRUFBRTtZQUNqQyxPQUFPLElBQUksTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzlEO1FBQ0QsUUFBUTtRQUNSLElBQUksU0FBUyxDQUFDLFFBQVEsQ0FBQyxRQUFRLENBQUMsSUFBSSxTQUFTLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxJQUFJLFNBQVMsQ0FBQyxRQUFRLENBQUMsTUFBTSxDQUFDLEVBQUU7WUFDNUYsT0FBTyxJQUFJLE1BQU0sQ0FBQyxVQUFVLENBQUMsTUFBTSxFQUFFLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQztTQUMxRDtRQUNELGdCQUFnQjtRQUNoQixJQUFJLFFBQVEsRUFBRTtZQUNaLE9BQU8sSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7U0FDOUQ7UUFFRDs7V0FFRztRQUNILE9BQU8sSUFBSSxNQUFNLENBQUMsVUFBVSxDQUFDLE1BQU0sRUFBRSxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDL0QsQ0FBQzs7QUFwTGMsOENBQWdDLEdBQWE7SUFDMUQsTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixNQUFNO0NBQ1AsQ0FBQztBQUVhLDhDQUFnQyxHQUFhO0lBQzFELFlBQVk7SUFDWixPQUFPO0lBQ1AsTUFBTTtJQUNOLFFBQVE7SUFDUixNQUFNO0lBQ04sT0FBTztJQUNQLEtBQUs7SUFDTCxRQUFRO0lBQ1IsVUFBVTtJQUNWLFFBQVE7SUFDUixhQUFhO0lBQ2IsU0FBUztJQUNULFNBQVM7SUFDVCxZQUFZO0lBQ1osWUFBWTtJQUNaLE1BQU07SUFDTixLQUFLO0lBQ0wsT0FBTztJQUNQLFlBQVk7SUFDWixTQUFTO0lBQ1QsWUFBWTtJQUNaLFNBQVM7SUFDVCxLQUFLO0lBQ0wsWUFBWTtDQUNiLENBQUM7QUFFYSw4Q0FBZ0MsR0FBYSxDQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUUsV0FBVyxFQUFFLFFBQVEsQ0FBQyxDQUFDOzs7Ozs7SUFySHhHLCtDQXdGRTs7Ozs7SUFFRiwrQ0F5QkU7Ozs7O0lBRUYsK0NBQXdHIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEZXZpY2UsIERldmljZVBsYXRmb3JtLCBEZXZpY2VUeXBlfSBmcm9tICcuL2RldmljZS5tb2RlbCc7XG5cbi8qKlxuICogc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9zcHJpbmctcHJvamVjdHMvc3ByaW5nLW1vYmlsZVxuICovXG5leHBvcnQgY2xhc3MgRGV2aWNlU2VydmljZSB7XG4gIHByaXZhdGUgc3RhdGljIEtOT1dOX01PQklMRV9VU0VSX0FHRU5UX1BSRUZJWEVTOiBzdHJpbmdbXSA9IFtcbiAgICAndzNjICcsXG4gICAgJ3czYy0nLFxuICAgICdhY3MtJyxcbiAgICAnYWxhdicsXG4gICAgJ2FsY2EnLFxuICAgICdhbW9pJyxcbiAgICAnYXZhbicsXG4gICAgJ2JlbnEnLFxuICAgICdiaXJkJyxcbiAgICAnYmxhYycsXG4gICAgJ2JsYXonLFxuICAgICdicmV3JyxcbiAgICAnY2VsbCcsXG4gICAgJ2NsZGMnLFxuICAgICdjbWQtJyxcbiAgICAnZGFuZycsXG4gICAgJ2RvY28nLFxuICAgICdlcmljJyxcbiAgICAnaGlwdCcsXG4gICAgJ2h0Y18nLFxuICAgICdpbm5vJyxcbiAgICAnaXBhcScsXG4gICAgJ2lwb2QnLFxuICAgICdqaWdzJyxcbiAgICAna2RkaScsXG4gICAgJ2tlamknLFxuICAgICdsZW5vJyxcbiAgICAnbGctYycsXG4gICAgJ2xnLWQnLFxuICAgICdsZy1nJyxcbiAgICAnbGdlLScsXG4gICAgJ2xnL3UnLFxuICAgICdtYXVpJyxcbiAgICAnbWF4bycsXG4gICAgJ21pZHAnLFxuICAgICdtaXRzJyxcbiAgICAnbW1lZicsXG4gICAgJ21vYmknLFxuICAgICdtb3QtJyxcbiAgICAnbW90bycsXG4gICAgJ213YnAnLFxuICAgICduZWMtJyxcbiAgICAnbmV3dCcsXG4gICAgJ25va2knLFxuICAgICdwYWxtJyxcbiAgICAncGFuYScsXG4gICAgJ3BhbnQnLFxuICAgICdwaGlsJyxcbiAgICAncGxheScsXG4gICAgJ3BvcnQnLFxuICAgICdwcm94JyxcbiAgICAncXdhcCcsXG4gICAgJ3NhZ2UnLFxuICAgICdzYW1zJyxcbiAgICAnc2FueScsXG4gICAgJ3NjaC0nLFxuICAgICdzZWMtJyxcbiAgICAnc2VuZCcsXG4gICAgJ3NlcmknLFxuICAgICdzZ2gtJyxcbiAgICAnc2hhcicsXG4gICAgJ3NpZS0nLFxuICAgICdzaWVtJyxcbiAgICAnc21hbCcsXG4gICAgJ3NtYXInLFxuICAgICdzb255JyxcbiAgICAnc3BoLScsXG4gICAgJ3N5bWInLFxuICAgICd0LW1vJyxcbiAgICAndGVsaScsXG4gICAgJ3RpbS0nLFxuICAgICd0b3NoJyxcbiAgICAndHNtLScsXG4gICAgJ3VwZzEnLFxuICAgICd1cHNpJyxcbiAgICAndmstdicsXG4gICAgJ3ZvZGEnLFxuICAgICd3YXAtJyxcbiAgICAnd2FwYScsXG4gICAgJ3dhcGknLFxuICAgICd3YXBwJyxcbiAgICAnd2FwcicsXG4gICAgJ3dlYmMnLFxuICAgICd3aW53JyxcbiAgICAnd2ludycsXG4gICAgJ3hkYSAnLFxuICAgICd4ZGEtJ1xuICBdO1xuXG4gIHByaXZhdGUgc3RhdGljIEtOT1dOX01PQklMRV9VU0VSX0FHRU5UX0tFWVdPUkRTOiBzdHJpbmdbXSA9IFtcbiAgICAnYmxhY2tiZXJyeScsXG4gICAgJ3dlYm9zJyxcbiAgICAnaXBvZCcsXG4gICAgJ2xnZSB2eCcsXG4gICAgJ21pZHAnLFxuICAgICdtYWVtbycsXG4gICAgJ21tcCcsXG4gICAgJ21vYmlsZScsXG4gICAgJ25ldGZyb250JyxcbiAgICAnaGlwdG9wJyxcbiAgICAnbmludGVuZG8gRFMnLFxuICAgICdub3ZhcnJhJyxcbiAgICAnb3BlbndlYicsXG4gICAgJ29wZXJhIG1vYmknLFxuICAgICdvcGVyYSBtaW5pJyxcbiAgICAncGFsbScsXG4gICAgJ3BzcCcsXG4gICAgJ3Bob25lJyxcbiAgICAnc21hcnRwaG9uZScsXG4gICAgJ3N5bWJpYW4nLFxuICAgICd1cC5icm93c2VyJyxcbiAgICAndXAubGluaycsXG4gICAgJ3dhcCcsXG4gICAgJ3dpbmRvd3MgY2UnXG4gIF07XG5cbiAgcHJpdmF0ZSBzdGF0aWMgS05PV05fVEFCTEVUX1VTRVJfQUdFTlRfS0VZV09SRFM6IHN0cmluZ1tdID0gWydpcGFkJywgJ3BsYXlib29rJywgJ2hwLXRhYmxldCcsICdraW5kbGUnXTtcblxuICBzdGF0aWMgcmVzb2x2ZURldmljZSh1c2VyQWdlbnQ6IHN0cmluZyk6IERldmljZSB7XG4gICAgaWYgKCF1c2VyQWdlbnQpIHtcbiAgICAgIHJldHVybiBuZXcgRGV2aWNlKERldmljZVR5cGUuTk9STUFMLCBEZXZpY2VQbGF0Zm9ybS5VTktOT1dOKTtcbiAgICB9XG5cbiAgICB1c2VyQWdlbnQgPSB1c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgIC8qKlxuICAgICAqIFRhYmxldCBEZXRlY3Rpb25cbiAgICAgKi9cblxuICAgIC8vIEFwcGxlXG4gICAgaWYgKHVzZXJBZ2VudC5pbmNsdWRlcygnaXBhZCcpKSB7XG4gICAgICByZXR1cm4gbmV3IERldmljZShEZXZpY2VUeXBlLlRBQkxFVCwgRGV2aWNlUGxhdGZvcm0uSU9TKTtcbiAgICB9XG5cbiAgICBjb25zdCBpc01vYmlsZTogYm9vbGVhbiA9XG4gICAgICB1c2VyQWdlbnQuaW5jbHVkZXMoJ21vYmlsZScpIHx8XG4gICAgICBEZXZpY2VTZXJ2aWNlLktOT1dOX01PQklMRV9VU0VSX0FHRU5UX0tFWVdPUkRTLnNvbWUobW9iaWxlVXNlckFnZW50ID0+IHVzZXJBZ2VudC5pbmNsdWRlcyhtb2JpbGVVc2VyQWdlbnQpKTtcbiAgICBpZiAoIWlzTW9iaWxlKSB7XG4gICAgICAvLyBBbmRyb2lkXG4gICAgICBpZiAodXNlckFnZW50LmluY2x1ZGVzKCdhbmRyb2lkJykpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEZXZpY2UoRGV2aWNlVHlwZS5UQUJMRVQsIERldmljZVBsYXRmb3JtLkFORFJPSUQpO1xuICAgICAgfVxuICAgICAgLy8gS2luZGxlIEZpcmVcbiAgICAgIGlmICh1c2VyQWdlbnQuaW5jbHVkZXMoJ3NpbGsnKSkge1xuICAgICAgICByZXR1cm4gbmV3IERldmljZShEZXZpY2VUeXBlLlRBQkxFVCwgRGV2aWNlUGxhdGZvcm0uVU5LTk9XTik7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIEZyb20ga2V5d29yZHNcbiAgICBpZiAoRGV2aWNlU2VydmljZS5LTk9XTl9UQUJMRVRfVVNFUl9BR0VOVF9LRVlXT1JEUy5zb21lKHRhYmxldFVzZXJBZ2VudCA9PiB1c2VyQWdlbnQuaW5jbHVkZXModGFibGV0VXNlckFnZW50KSkpIHtcbiAgICAgIHJldHVybiBuZXcgRGV2aWNlKERldmljZVR5cGUuVEFCTEVULCBEZXZpY2VQbGF0Zm9ybS5VTktOT1dOKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNb2JpbGUgZGV0ZWN0aW9uXG4gICAgICovXG4gICAgLy8gRnJvbSBwcmVmaXhcbiAgICBpZiAoXG4gICAgICB1c2VyQWdlbnQubGVuZ3RoID49IDQgJiZcbiAgICAgIERldmljZVNlcnZpY2UuS05PV05fTU9CSUxFX1VTRVJfQUdFTlRfUFJFRklYRVMuaW5kZXhPZih1c2VyQWdlbnQuc3Vic3RyaW5nKDAsIDQpKSAhPT0gLTFcbiAgICApIHtcbiAgICAgIHJldHVybiBuZXcgRGV2aWNlKERldmljZVR5cGUuTU9CSUxFLCBEZXZpY2VQbGF0Zm9ybS5VTktOT1dOKTtcbiAgICB9XG4gICAgLy8gQW5kcm9pZFxuICAgIGlmICh1c2VyQWdlbnQuaW5jbHVkZXMoJ2FuZHJvaWQnKSkge1xuICAgICAgcmV0dXJuIG5ldyBEZXZpY2UoRGV2aWNlVHlwZS5NT0JJTEUsIERldmljZVBsYXRmb3JtLkFORFJPSUQpO1xuICAgIH1cbiAgICAvLyBBcHBsZVxuICAgIGlmICh1c2VyQWdlbnQuaW5jbHVkZXMoJ2lwaG9uZScpIHx8IHVzZXJBZ2VudC5pbmNsdWRlcygnaXBvZCcpIHx8IHVzZXJBZ2VudC5pbmNsdWRlcygnaXBhZCcpKSB7XG4gICAgICByZXR1cm4gbmV3IERldmljZShEZXZpY2VUeXBlLk1PQklMRSwgRGV2aWNlUGxhdGZvcm0uSU9TKTtcbiAgICB9XG4gICAgLy8gRnJvbSBrZXl3b3Jkc1xuICAgIGlmIChpc01vYmlsZSkge1xuICAgICAgcmV0dXJuIG5ldyBEZXZpY2UoRGV2aWNlVHlwZS5NT0JJTEUsIERldmljZVBsYXRmb3JtLlVOS05PV04pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqID0+IE5vcm1hbCBkZXZpY2VcbiAgICAgKi9cbiAgICByZXR1cm4gbmV3IERldmljZShEZXZpY2VUeXBlLk5PUk1BTCwgRGV2aWNlUGxhdGZvcm0uVU5LTk9XTik7XG4gIH1cbn1cbiJdfQ==