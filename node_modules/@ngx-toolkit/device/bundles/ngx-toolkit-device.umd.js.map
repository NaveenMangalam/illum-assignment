{"version":3,"file":"ngx-toolkit-device.umd.js","sources":["ng://@ngx-toolkit/device/lib/device.model.ts","ng://@ngx-toolkit/device/lib/device.token.ts","ng://@ngx-toolkit/device/lib/device.service.ts","ng://@ngx-toolkit/device/lib/device.module.ts"],"sourcesContent":["export enum DeviceType {\n  TABLET = 0,\n  MOBILE,\n  NORMAL\n}\n\nexport enum DevicePlatform {\n  ANDROID = 0,\n  IOS,\n  UNKNOWN\n}\n\nexport class Device {\n  type: DeviceType;\n  platform: DevicePlatform;\n\n  constructor(type: DeviceType = DeviceType.NORMAL, platform: DevicePlatform = DevicePlatform.UNKNOWN) {\n    this.type = type;\n    this.platform = platform;\n  }\n\n  isNormal(): boolean {\n    return this.type === DeviceType.NORMAL;\n  }\n\n  isMobile(): boolean {\n    return this.type === DeviceType.MOBILE;\n  }\n\n  isTablet(): boolean {\n    return this.type === DeviceType.TABLET;\n  }\n}\n","import {InjectionToken} from '@angular/core';\nimport {Device} from './device.model';\n\nexport const USER_AGENT = new InjectionToken<string>('USER_AGENT');\nexport const DEVICE = new InjectionToken<Device>('DEVICE');\n","import {Device, DevicePlatform, DeviceType} from './device.model';\n\n/**\n * see https://github.com/spring-projects/spring-mobile\n */\nexport class DeviceService {\n  private static KNOWN_MOBILE_USER_AGENT_PREFIXES: string[] = [\n    'w3c ',\n    'w3c-',\n    'acs-',\n    'alav',\n    'alca',\n    'amoi',\n    'avan',\n    'benq',\n    'bird',\n    'blac',\n    'blaz',\n    'brew',\n    'cell',\n    'cldc',\n    'cmd-',\n    'dang',\n    'doco',\n    'eric',\n    'hipt',\n    'htc_',\n    'inno',\n    'ipaq',\n    'ipod',\n    'jigs',\n    'kddi',\n    'keji',\n    'leno',\n    'lg-c',\n    'lg-d',\n    'lg-g',\n    'lge-',\n    'lg/u',\n    'maui',\n    'maxo',\n    'midp',\n    'mits',\n    'mmef',\n    'mobi',\n    'mot-',\n    'moto',\n    'mwbp',\n    'nec-',\n    'newt',\n    'noki',\n    'palm',\n    'pana',\n    'pant',\n    'phil',\n    'play',\n    'port',\n    'prox',\n    'qwap',\n    'sage',\n    'sams',\n    'sany',\n    'sch-',\n    'sec-',\n    'send',\n    'seri',\n    'sgh-',\n    'shar',\n    'sie-',\n    'siem',\n    'smal',\n    'smar',\n    'sony',\n    'sph-',\n    'symb',\n    't-mo',\n    'teli',\n    'tim-',\n    'tosh',\n    'tsm-',\n    'upg1',\n    'upsi',\n    'vk-v',\n    'voda',\n    'wap-',\n    'wapa',\n    'wapi',\n    'wapp',\n    'wapr',\n    'webc',\n    'winw',\n    'winw',\n    'xda ',\n    'xda-'\n  ];\n\n  private static KNOWN_MOBILE_USER_AGENT_KEYWORDS: string[] = [\n    'blackberry',\n    'webos',\n    'ipod',\n    'lge vx',\n    'midp',\n    'maemo',\n    'mmp',\n    'mobile',\n    'netfront',\n    'hiptop',\n    'nintendo DS',\n    'novarra',\n    'openweb',\n    'opera mobi',\n    'opera mini',\n    'palm',\n    'psp',\n    'phone',\n    'smartphone',\n    'symbian',\n    'up.browser',\n    'up.link',\n    'wap',\n    'windows ce'\n  ];\n\n  private static KNOWN_TABLET_USER_AGENT_KEYWORDS: string[] = ['ipad', 'playbook', 'hp-tablet', 'kindle'];\n\n  static resolveDevice(userAgent: string): Device {\n    if (!userAgent) {\n      return new Device(DeviceType.NORMAL, DevicePlatform.UNKNOWN);\n    }\n\n    userAgent = userAgent.toLowerCase();\n\n    /**\n     * Tablet Detection\n     */\n\n    // Apple\n    if (userAgent.includes('ipad')) {\n      return new Device(DeviceType.TABLET, DevicePlatform.IOS);\n    }\n\n    const isMobile: boolean =\n      userAgent.includes('mobile') ||\n      DeviceService.KNOWN_MOBILE_USER_AGENT_KEYWORDS.some(mobileUserAgent => userAgent.includes(mobileUserAgent));\n    if (!isMobile) {\n      // Android\n      if (userAgent.includes('android')) {\n        return new Device(DeviceType.TABLET, DevicePlatform.ANDROID);\n      }\n      // Kindle Fire\n      if (userAgent.includes('silk')) {\n        return new Device(DeviceType.TABLET, DevicePlatform.UNKNOWN);\n      }\n    }\n    // From keywords\n    if (DeviceService.KNOWN_TABLET_USER_AGENT_KEYWORDS.some(tabletUserAgent => userAgent.includes(tabletUserAgent))) {\n      return new Device(DeviceType.TABLET, DevicePlatform.UNKNOWN);\n    }\n\n    /**\n     * Mobile detection\n     */\n    // From prefix\n    if (\n      userAgent.length >= 4 &&\n      DeviceService.KNOWN_MOBILE_USER_AGENT_PREFIXES.indexOf(userAgent.substring(0, 4)) !== -1\n    ) {\n      return new Device(DeviceType.MOBILE, DevicePlatform.UNKNOWN);\n    }\n    // Android\n    if (userAgent.includes('android')) {\n      return new Device(DeviceType.MOBILE, DevicePlatform.ANDROID);\n    }\n    // Apple\n    if (userAgent.includes('iphone') || userAgent.includes('ipod') || userAgent.includes('ipad')) {\n      return new Device(DeviceType.MOBILE, DevicePlatform.IOS);\n    }\n    // From keywords\n    if (isMobile) {\n      return new Device(DeviceType.MOBILE, DevicePlatform.UNKNOWN);\n    }\n\n    /**\n     * => Normal device\n     */\n    return new Device(DeviceType.NORMAL, DevicePlatform.UNKNOWN);\n  }\n}\n","import {ModuleWithProviders, NgModule, Optional} from '@angular/core';\nimport {Device} from './device.model';\nimport {DeviceService} from './device.service';\nimport {DEVICE, USER_AGENT} from './device.token';\n\nexport function deviceResolverFactory(userAgent?: string): Device {\n  if (!userAgent && window) {\n    userAgent = window.navigator.userAgent;\n  }\n\n  return DeviceService.resolveDevice(userAgent);\n}\n\n@NgModule()\nexport class DeviceModule {\n  /**\n   * In root module to provide the DEVICE\n   */\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: DeviceModule,\n      providers: [\n        {\n          provide: DEVICE,\n          useFactory: deviceResolverFactory,\n          deps: [[new Optional(), USER_AGENT]]\n        }\n      ]\n    };\n  }\n}\n"],"names":["InjectionToken","Optional","NgModule"],"mappings":"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"}